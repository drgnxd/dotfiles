# ~/.config/zsh/.exports
# Environment variables for the shell

# ------------------------------------------------------------------------------
# XDG Base Directory Specification
# ------------------------------------------------------------------------------
# Standard XDG locations
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_STATE_HOME="$HOME/.local/state"

# ------------------------------------------------------------------------------
# Application-specific homes
# ------------------------------------------------------------------------------
# GnuPG
export GNUPGHOME="$HOME/.config/gnupg"

# Cargo (Rust)
export CARGO_HOME="$XDG_DATA_HOME/cargo"

# npm (Node.js)
export NPM_CONFIG_PREFIX="$HOME/.config/npm/global"
export NPM_CONFIG_CACHE="$HOME/.cache/npm"
export NPM_CONFIG_USERCONFIG="$HOME/.config/npm/npmrc"

# Pyenv
export PYENV_ROOT="$HOME/.local/share/.pyenv"

# Taskwarrior
export TASKRC="${HOME}/.config/taskwarrior/config"
export TASKDATA="${HOME}/.local/share/taskwarrior"

# zk
export ZK_NOTEBOOK_DIR="$HOME/dev/zettel"
export ZK_EDITOR="hx"

# zoxide
export _ZO_DATA_DIR="$XDG_DATA_HOME/zoxide"

# bat
export BAT_CONFIG_DIR="$XDG_CONFIG_HOME/bat"
export BAT_CACHE_DIR="$XDG_CACHE_HOME/bat"

# Starship
export STARSHIP_CONFIG="$XDG_CONFIG_HOME/starship/starship.toml"

# Terminfo
export TERMINFO_DIRS="$XDG_DATA_HOME/terminfo:/usr/share/terminfo"
export TERMINFO="$XDG_DATA_HOME/terminfo"

# Scilab
export SCIHOME="$XDG_CONFIG_HOME/scilab"

# macOS Session state
export SHELL_SESSION_DIR="$XDG_STATE_HOME/zsh/sessions"

# ------------------------------------------------------------------------------
# Shell history (XDG compliant)
# ------------------------------------------------------------------------------
export HISTFILE="$HOME/.local/state/zsh/history"
export LESSHISTFILE="$HOME/.local/state/less/history"

# ------------------------------------------------------------------------------
# LLVM (Homebrew)
# ------------------------------------------------------------------------------
# Only non-PATH flags (LDFLAGS, CPPFLAGS)
export LDFLAGS="-L/opt/homebrew/opt/llvm/lib"
export CPPFLAGS="-I/opt/homebrew/opt/llvm/include"

# ------------------------------------------------------------------------------
# Terminal settings
# ------------------------------------------------------------------------------
# Prefer native terminfo entries to expose undercurl/truecolor
if [[ -n "$TMUX" ]]; then
  export TERM="tmux-256color"
else
  # Respect terminal-provided TERM; only set a safe default when missing
  export TERM="${TERM:-xterm-256color}"
fi
export COLORTERM="truecolor"

# ------------------------------------------------------------------------------
# Default editor (e.g., chezmoi edit)
# ------------------------------------------------------------------------------
# Use hx in the terminal
export EDITOR="hx"
export VISUAL="$EDITOR"

# ------------------------------------------------------------------------------
# $PATH configuration
# ------------------------------------------------------------------------------
# Deduplicate PATH and prepend preferred locations (Steel LSP is in cargo bin)
typeset -U path PATH
path=(
  "$HOME/.local/bin"
  "$CARGO_HOME/bin"
  "$NPM_CONFIG_PREFIX/bin"
  "/opt/homebrew/opt/llvm/bin"
  $path
)
export PATH
