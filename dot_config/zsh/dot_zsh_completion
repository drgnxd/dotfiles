# ~/.config/zsh/.zsh_completion

# ------------------------------------------------------------------------------
# 1. zsh-completions path setting (must be done before compinit)
# ------------------------------------------------------------------------------
# Use HOMEBREW_PREFIX set in .homebrew
if [ -n "$HOMEBREW_PREFIX" ] && [ -d "$HOMEBREW_PREFIX/share/zsh-completions" ]; then
  fpath=("$HOMEBREW_PREFIX/share/zsh-completions" $fpath)
fi

# ------------------------------------------------------------------------------
# 2. Initialize completion system
# ------------------------------------------------------------------------------
autoload -U compinit
# Skip security check for speed (-C: use cache)
compinit -C

# ------------------------------------------------------------------------------
# 3. Style settings (Improve visibility)
# ------------------------------------------------------------------------------
# Enable menu selection for completion candidates
zstyle ':completion:*' menu select

# Show descriptions for completion candidates (e.g., --help  -- display usage information)
zstyle ':completion:*' verbose yes
zstyle ':completion:*:descriptions' format '%F{green}-- %d --%f'
zstyle ':completion:*:messages' format '%F{yellow}%d%f'
zstyle ':completion:*:warnings' format '%F{red}No matches for: %d%f'

# Group completion candidates (Distinguish commands, aliases, files, etc.)
zstyle ':completion:*' group-name ''

# Case insensitive matching
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z}'

# Colorize completion list for ls command etc.
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"