# ~/.config/zsh/.exports
# Environment variables for the shell

# ------------------------------------------------------------------------------
# XDG Base Directory Specification
# ------------------------------------------------------------------------------
# Standard XDG locations
: "${XDG_CONFIG_HOME:=$HOME/.config}"
: "${XDG_CACHE_HOME:=$HOME/.cache}"
: "${XDG_DATA_HOME:=$HOME/.local/share}"
: "${XDG_STATE_HOME:=$HOME/.local/state}"
export XDG_CONFIG_HOME XDG_CACHE_HOME XDG_DATA_HOME XDG_STATE_HOME

# ------------------------------------------------------------------------------
# Application-specific homes
# ------------------------------------------------------------------------------
# GnuPG
export GNUPGHOME="$XDG_CONFIG_HOME/gnupg"

# Cargo (Rust)
export CARGO_HOME="$XDG_DATA_HOME/cargo"

# npm (Node.js)
export NPM_CONFIG_PREFIX="$XDG_CONFIG_HOME/npm/global"
export NPM_CONFIG_CACHE="$XDG_CACHE_HOME/npm"
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"

# Taskwarrior
export TASKRC="$XDG_CONFIG_HOME/taskwarrior/config"
export TASKDATA="$XDG_DATA_HOME/taskwarrior"

# zk
export ZK_NOTEBOOK_DIR="$HOME/dev/zettel"
export ZK_EDITOR="hx"

# zoxide
export _ZO_DATA_DIR="$XDG_DATA_HOME/zoxide"

# bat
export BAT_CONFIG_DIR="$XDG_CONFIG_HOME/bat"
export BAT_CACHE_DIR="$XDG_CACHE_HOME/bat"

# Starship
export STARSHIP_CONFIG="$XDG_CONFIG_HOME/starship/starship.toml"

# Terminfo
export TERMINFO_DIRS="$XDG_DATA_HOME/terminfo:/usr/share/terminfo"
export TERMINFO="$XDG_DATA_HOME/terminfo"

# Scilab
export SCIHOME="$XDG_CONFIG_HOME/scilab"

# ShellCheck
export SHELLCHECK_OPTS="--rcfile=$XDG_CONFIG_HOME/shellcheck/shellcheckrc"

# Docker
export DOCKER_CONFIG="$XDG_CONFIG_HOME/docker"

# Lima
export LIMA_HOME="$XDG_DATA_HOME/lima"

# Ollama
export OLLAMA_MODELS="${XDG_DATA_HOME:-$HOME/.local/share}/ollama/models"
export OLLAMA_FLASH_ATTENTION="1"
export OLLAMA_KV_CACHE_TYPE="q8_0"
export OLLAMA_KEEP_ALIVE="5m"
export OLLAMA_ORIGINS="moz-extension://*"

# macOS Session state
export SHELL_SESSION_DIR="$XDG_STATE_HOME/zsh/sessions"

# ------------------------------------------------------------------------------
# Shell history (XDG compliant)
# ------------------------------------------------------------------------------
export HISTFILE="$XDG_STATE_HOME/zsh/history"
export LESSHISTFILE="$XDG_STATE_HOME/less/history"

# ------------------------------------------------------------------------------
# LLVM (Homebrew)
# ------------------------------------------------------------------------------
# Only non-PATH flags (LDFLAGS, CPPFLAGS)
export LDFLAGS="-L/opt/homebrew/opt/llvm/lib"
export CPPFLAGS="-I/opt/homebrew/opt/llvm/include"

# ------------------------------------------------------------------------------
# Terminal settings
# ------------------------------------------------------------------------------
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8
# LS_COLORS for Solarized Dark (High visibility)
# di=directory, ln=symlink, ex=executable, etc.
# Uses standard ANSI colors mapped by Solarized: 
# 34=blue, 35=magenta, 32=green, 33=yellow, 31=red
export LS_COLORS="di=1;34:ln=1;36:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43"
# Enable color support for ls and other commands
export CLICOLOR=1
export LSCOLORS="Gxfxcxdxbxegedabagacad" # BSD ls compatibility (Solarized approximation)

# Prefer native terminfo entries to expose undercurl/truecolor
if [[ -n "$TMUX" ]]; then
  export TERM="tmux-256color"
else
  # Respect terminal-provided TERM; only set a safe default when missing
  export TERM="${TERM:-xterm-256color}"
fi
export COLORTERM="truecolor"

# ------------------------------------------------------------------------------
# Default editor (e.g., chezmoi edit)
# ------------------------------------------------------------------------------
# Use hx in the terminal
export EDITOR="hx"
export VISUAL="$EDITOR"

# ------------------------------------------------------------------------------
# $PATH configuration
# ------------------------------------------------------------------------------
# Deduplicate PATH and prepend preferred locations (Steel LSP is in cargo bin)
typeset -U path PATH
path=(
  "$HOME/.local/bin"
  "$CARGO_HOME/bin"
  "$NPM_CONFIG_PREFIX/bin"
  "/opt/homebrew/opt/llvm/bin"
  $path
)
export PATH
