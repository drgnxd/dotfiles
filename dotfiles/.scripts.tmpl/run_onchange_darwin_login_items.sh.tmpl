#!/bin/sh

set -euo pipefail

if ! command -v chezmoi >/dev/null 2>&1; then
  echo "chezmoi not found in PATH" >&2
  exit 1
fi

template="{{ .chezmoi.sourceDir }}/.scripts/darwin/login_items.sh.tmpl"

if [ ! -f "$template" ]; then
  echo "Template not found: $template" >&2
  exit 1
fi

tmp_file="$(mktemp)"
cleanup() {
  rm -f "$tmp_file"
}
trap cleanup EXIT

chezmoi execute-template < "$template" > "$tmp_file"
chmod +x "$tmp_file"
"$tmp_file" "$@"
